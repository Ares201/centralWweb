import{_ as E}from"./BOu3swiP.js";import{e as N,r as x,A as V,D as F,B as S,z as h,E as T,G as w,H as z,y as B,T as $,g as j,j as G,c as m,a as e,b as _,k as C,w as M,q as P,v as b,x as k,F as U,l as H,p as D,o as g,t as p}from"./BlC0kOmC.js";import{P as L}from"./CDl1cRGV.js";import"./ChZAjdJc.js";const I=()=>{const{$db:i}=N(),d=x([]),y=x(!0),c=async()=>{try{const t=await S(h(i,"quotations"));d.value=t.docs.map(s=>{const l=s.data();return{id:s.id,name:l.name,phone:l.phone,comment:l.comment,createdAt:l.createdAt.toDate()}})}catch(t){console.error("Error loading quotations:",t)}finally{y.value=!1}};V(c);const f=async t=>{await B(h(i,"quotations"),{...t,createdAt:$.now()}),await c()},u=async(t,s)=>{await z(w(i,"quotations",t),s),await c()},r=async t=>{await T(w(i,"quotations",t)),d.value=d.value.filter(s=>s.id!==t)};return{quotations:F(d),addQuotation:f,updateQuotation:u,deleteQuotation:r}},J={class:"min-h-screen mt-4"},K={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"mb-8"},R={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},W={class:"flex items-center"},X={key:0,class:"mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700"},Y={class:"bg-white dark:bg-gray-800 shadow overflow-hidden sm:rounded-md"},Z={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ee={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},te={class:"px-6 py-4 whitespace-nowrap"},ae={class:"text-sm font-medium text-gray-900 dark:text-white"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},re={class:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ne={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},de=["onClick"],le=["onClick"],ge=j({__name:"quotations",setup(i){const{quotations:d,addQuotation:y,updateQuotation:c,deleteQuotation:f}=I(),u=x(!1),r=x(null);G(()=>!!r.value);const t=x({name:"",phone:"",comment:""}),s=n=>{r.value=n,t.value={name:n.name,phone:n.phone,comment:n.comment}},l=n=>{confirm("¿Estás seguro de que quieres eliminar esta cotización?")&&f(n)},A=()=>{r.value?c(r.value.id,t.value):y(t.value),v()},v=()=>{u.value=!1,r.value=null,t.value={name:"",phone:"",comment:""}};return(n,a)=>{const Q=E;return g(),m("div",J,[e("div",K,[e("div",O,[_(Q,null,{default:M(()=>[e("div",R,[a[4]||(a[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Gestión de Cotizaciones "),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Administra las solicitudes de cotización ")],-1)),e("div",W,[n.isAdmin?(g(),m("button",{key:0,onClick:a[0]||(a[0]=o=>u.value=!0),class:"w-9 h-9 rounded-full flex items-center justify-center bg-orange-500 hover:bg-orange-600 transition"},[_(D(L),{class:"h-4 w-4 text-white"})])):C("",!0)])])]),_:1}),u.value||r.value?(g(),m("div",X,[e("form",{onSubmit:P(A,["prevent"]),class:"space-y-4"},[e("div",null,[a[5]||(a[5]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Nombre ",-1)),b(e("input",{id:"name","onUpdate:modelValue":a[1]||(a[1]=o=>t.value.name=o),type:"text",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white"},null,512),[[k,t.value.name]])]),e("div",null,[a[6]||(a[6]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Teléfono ",-1)),b(e("input",{id:"phone","onUpdate:modelValue":a[2]||(a[2]=o=>t.value.phone=o),type:"tel",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white"},null,512),[[k,t.value.phone]])]),e("div",null,[a[7]||(a[7]=e("label",{for:"comment",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Comentario ",-1)),b(e("textarea",{id:"comment","onUpdate:modelValue":a[3]||(a[3]=o=>t.value.comment=o),required:"",rows:"3",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-700 dark:text-white"},null,512),[[k,t.value.comment]])]),e("div",{class:"flex gap-2"},[a[8]||(a[8]=e("button",{type:"submit",class:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-md"},"Guardar",-1)),e("button",{type:"button",onClick:v,class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300 rounded-md"},"Cancelar")])],32)])):C("",!0)]),e("div",Y,[e("table",Z,[a[9]||(a[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Nombre"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Teléfono"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Comentario"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Fecha"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Acciones")])],-1)),e("tbody",ee,[(g(!0),m(U,null,H(D(d),o=>(g(),m("tr",{key:o.id},[e("td",te,[e("div",ae,p(o.name),1)]),e("td",oe,p(o.phone),1),e("td",re,p(o.comment),1),e("td",se,p(new Date(o.createdAt).toLocaleDateString()),1),e("td",ne,[e("button",{onClick:q=>s(o),class:"text-orange-600 hover:text-orange-900 dark:text-orange-400 dark:hover:text-orange-300 mr-4"}," Editar ",8,de),e("button",{onClick:q=>l(o.id),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"}," Eliminar ",8,le)])]))),128))])])])])])}}});export{ge as default};
