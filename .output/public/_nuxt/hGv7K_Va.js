import{_ as j}from"./Biot2hfR.js";import{e as N,r as x,A as S,D as B,B as F,z as k,E as M,G as _,H as $,T as w,y as z,g as P,j as T,c as l,a as e,b as U,k as y,w as G,F as H,l as R,p as A,t as g,q as I,v as b,x as C,I as L,o as i}from"./BHJO8Hug.js";import{P as J}from"./CPlP1aPT.js";import"./DjdgY1im.js";const K=()=>{const{$db:c}=N(),u=x([]),f=x(!0),m=async()=>{try{const r=await F(k(c,"users"));u.value=r.docs.map(s=>{const n=s.data();return{id:s.id,username:n.username,password:n.password,role:n.role||"user",createdAt:n.createdAt.toDate(),updatedAt:n.updatedAt.toDate()}})}catch(r){console.error("Error loading users:",r)}finally{f.value=!1}};S(m);const v=async r=>{await z(k(c,"users"),{...r,createdAt:w.now(),updatedAt:w.now()}),await m()},p=async(r,s)=>{await $(_(c,"users",r),{...s,updatedAt:w.now()}),await m()},d=async r=>{await M(_(c,"users",r)),u.value=u.value.filter(s=>s.id!==r)};return{users:B(u),addUser:v,updateUser:p,deleteUser:d}},O={class:"min-h-screen mt-4"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},W={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},X={class:"flex items-center"},Y={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden"},Z={class:"min-w-full divide-y"},ee={class:"divide-y divide-gray-200"},te={class:"px-6 py-4 whitespace-nowrap"},se={class:"flex items-center"},re={class:"flex-shrink-0 h-10 w-10"},ae={class:"h-10 w-10 rounded-full bg-orange-500 flex items-center justify-center"},oe={class:"text-white font-medium"},de={class:"ml-4"},ne={class:"text-sm font-medium text-gray-900 dark:text-white"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ie={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ue=["onClick"],ce=["onClick"],me={key:0,class:"fixed inset-0 bg-gray-800 bg-opacity-50 overflow-y-auto h-full w-full z-50"},pe={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-gray-800 dark:bg-gray-800"},ge={class:"mt-3"},xe={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},ye={class:"flex justify-end space-x-3 pt-4"},fe={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},ke=P({__name:"users",setup(c){const{users:u,addUser:f,updateUser:m,deleteUser:v}=K(),p=x(!1),d=x(null),r=T(()=>!!d.value),s=x({username:"",password:"",role:"user"}),n=o=>{d.value=o,s.value={username:o.username,password:o.password,role:o.role}},D=o=>{confirm("¿Estás seguro de que quieres eliminar este usuario?")&&v(o)},E=()=>{d.value?m(d.value.id,s.value):f(s.value),h()},h=()=>{p.value=!1,d.value=null,s.value={username:"",password:"",role:"user"}};return(o,t)=>{const q=j;return i(),l("div",O,[e("div",Q,[U(q,null,{default:G(()=>[e("div",W,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"}," Gestión de Usuarios ")],-1)),e("div",X,[o.isAdmin?(i(),l("button",{key:0,onClick:t[0]||(t[0]=a=>p.value=!0),class:"w-9 h-9 rounded-full flex items-center justify-center bg-orange-500 hover:bg-orange-600 transition"},[U(A(J),{class:"h-4 w-4 text-white"})])):y("",!0)])])]),_:1}),e("div",Y,[e("table",Z,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Usuario"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Rol"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Acciones")])],-1)),e("tbody",ee,[(i(!0),l(H,null,R(A(u),a=>(i(),l("tr",{key:a.id},[e("td",te,[e("div",se,[e("div",re,[e("div",ae,[e("span",oe,g(a.username.charAt(0).toUpperCase()),1)])]),e("div",de,[e("div",ne,g(a.username),1)])])]),e("td",le,g(a.role==="admin"?"Administrador":"Usuario"),1),e("td",ie,[o.isAdmin?(i(),l("button",{key:0,onClick:V=>n(a),class:"text-orange-600 hover:text-orange-900 dark:text-orange-400 dark:hover:text-orange-300 mr-4"}," Editar ",8,ue)):y("",!0),o.isAdmin?(i(),l("button",{key:1,onClick:V=>D(a.id),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"}," Eliminar ",8,ce)):y("",!0)])]))),128))])])]),p.value||d.value?(i(),l("div",me,[e("div",pe,[e("div",ge,[e("h3",xe,g(r.value?"Editar Usuario":"Nuevo Usuario"),1),e("form",{onSubmit:I(E,["prevent"]),class:"space-y-4"},[e("div",null,[t[6]||(t[6]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Usuario ",-1)),b(e("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.username=a),type:"text",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},null,512),[[C,s.value.username]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Contraseña ",-1)),b(e("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.password=a),type:"password",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},null,512),[[C,s.value.password]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Rol ",-1)),b(e("select",{id:"role","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.role=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},[...t[8]||(t[8]=[e("option",{value:"user"},"Usuario",-1),e("option",{value:"admin"},"Administrador",-1)])],512),[[L,s.value.role]])]),e("div",ye,[e("button",{onClick:h,type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-800 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600"}," Cancelar "),e("button",fe,g(r.value?"Actualizar":"Crear"),1)])],32)])])])):y("",!0)])])}}});export{ke as default};
