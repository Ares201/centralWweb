import{e as N,r as x,A as S,E as V,B as j,z as h,G as B,H as _,I as M,T as b,y as F,g as T,j as U,c as l,a as e,k as y,d as $,F as z,l as R,p as G,t as p,q as H,v as k,x as A,J as I,o as i}from"./CyYbDFE6.js";const J=()=>{const{$db:c}=N(),u=x([]),v=x(!0),m=async()=>{try{const r=await j(h(c,"users"));u.value=r.docs.map(o=>{const s=o.data();return{id:o.id,username:s.username,password:s.password,role:s.role||"user",createdAt:s.createdAt.toDate(),updatedAt:s.updatedAt.toDate()}})}catch(r){console.error("Error loading users:",r)}finally{v.value=!1}};S(m);const f=async r=>{await F(h(c,"users"),{...r,createdAt:b.now(),updatedAt:b.now()}),await m()},g=async(r,o)=>{await M(_(c,"users",r),{...o,updatedAt:b.now()}),await m()},d=async r=>{await B(_(c,"users",r)),u.value=u.value.filter(o=>o.id!==r)};return{users:V(u),addUser:f,updateUser:g,deleteUser:d}},L={class:"min-h-screen bg-gray-800 dark:bg-gray-800 py-8"},K={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"mb-8"},P={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Q={class:"mt-4 sm:mt-0"},W={class:"bg-gray-800 dark:bg-gray-800 shadow overflow-hidden sm:rounded-md"},X={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Y={class:"bg-gray-800 dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Z={class:"px-6 py-4 whitespace-nowrap"},ee={class:"flex items-center"},te={class:"flex-shrink-0 h-10 w-10"},se={class:"h-10 w-10 rounded-full bg-orange-500 flex items-center justify-center"},re={class:"text-white font-medium"},ae={class:"ml-4"},oe={class:"text-sm font-medium text-gray-900 dark:text-white"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ne={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},le=["onClick"],ie=["onClick"],ue={key:0,class:"fixed inset-0 bg-gray-800 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ce={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-gray-800 dark:bg-gray-800"},me={class:"mt-3"},ge={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},pe={class:"flex justify-end space-x-3 pt-4"},xe={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},ve=T({__name:"users",setup(c){const{users:u,addUser:v,updateUser:m,deleteUser:f}=J(),g=x(!1),d=x(null),r=U(()=>localStorage.getItem("userRole")==="admin"),o=U(()=>!!d.value),s=x({username:"",password:"",role:"user"}),C=n=>{d.value=n,s.value={username:n.username,password:n.password,role:n.role}},D=n=>{confirm("¿Estás seguro de que quieres eliminar este usuario?")&&f(n)},E=()=>{d.value?m(d.value.id,s.value):v(s.value),w()},w=()=>{g.value=!1,d.value=null,s.value={username:"",password:"",role:"user"}};return(n,t)=>(i(),l("div",L,[e("div",K,[e("div",O,[e("div",P,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"Gestión de Usuarios"),e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," Administra los usuarios del sistema ")],-1)),e("div",Q,[r.value?(i(),l("button",{key:0,onClick:t[0]||(t[0]=a=>g.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},[...t[4]||(t[4]=[e("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),$(" Nuevo Usuario ",-1)])])):y("",!0)])])]),e("div",W,[e("table",X,[t[6]||(t[6]=e("thead",{class:"bg-gray-800 dark:bg-gray-800"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Usuario"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Rol"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",Y,[(i(!0),l(z,null,R(G(u),a=>(i(),l("tr",{key:a.id},[e("td",Z,[e("div",ee,[e("div",te,[e("div",se,[e("span",re,p(a.username.charAt(0).toUpperCase()),1)])]),e("div",ae,[e("div",oe,p(a.username),1)])])]),e("td",de,p(a.role==="admin"?"Administrador":"Usuario"),1),e("td",ne,[r.value?(i(),l("button",{key:0,onClick:q=>C(a),class:"text-orange-600 hover:text-orange-900 dark:text-orange-400 dark:hover:text-orange-300 mr-4"}," Editar ",8,le)):y("",!0),r.value?(i(),l("button",{key:1,onClick:q=>D(a.id),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"}," Eliminar ",8,ie)):y("",!0)])]))),128))])])]),g.value||d.value?(i(),l("div",ue,[e("div",ce,[e("div",me,[e("h3",ge,p(o.value?"Editar Usuario":"Nuevo Usuario"),1),e("form",{onSubmit:H(E,["prevent"]),class:"space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Usuario ",-1)),k(e("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.username=a),type:"text",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},null,512),[[A,s.value.username]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Contraseña ",-1)),k(e("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.password=a),type:"password",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},null,512),[[A,s.value.password]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Rol ",-1)),k(e("select",{id:"role","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.role=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 dark:bg-gray-800 dark:text-white"},[...t[9]||(t[9]=[e("option",{value:"user"},"Usuario",-1),e("option",{value:"admin"},"Administrador",-1)])],512),[[I,s.value.role]])]),e("div",pe,[e("button",{onClick:w,type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-800 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600"}," Cancelar "),e("button",xe,p(o.value?"Actualizar":"Crear"),1)])],32)])])])):y("",!0)])]))}});export{ve as default};
